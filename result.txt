Query 1: Correct Identified as Semantic
Query Mentioned Misspelled {Kathleen Vasqez}
Semantic Search Returned Result of Correct {Kathleen Vasquez}

Query 2: Correctly Identified as SQL_QUERY

[INFO] AzureOpenAI Client configured successfully for deployment: auxee-gpt-4o

--- Data Pipeline Execution Started ---
[INFO] Converting 'loan.xlsx' to Parquet...
[SUCCESS] Parquet file saved at: ../data/loan_20251209194135_c3ba6776.parquet

--- Starting Ingestion for Collection: 'data_source_loan' ---
Data loaded: 1000 rows.
Generated 500 chunks.
Starting vector embedding using Azure Deployment: auxzee-text-embedding-ada-002...
Embedding complete. Vector dimension: 1536
Preparing to insert 500 documents into MongoDB...
Clearing old documents from 'data_source_loan'...
Attempting to insert 500 documents...
Successfully inserted 500 chunks. (Write Acknowledged)
[WAIT] Waiting 5 seconds for Atlas Search indexing to catch up with new data...
[INFO] Atlas Vector Search Index 'vector_index' already exists on 'data_source_loan'. Checking status...
[SUCCESS] Index 'vector_index' is active and ready for search.

[SUCCESS] Vector DB is up-to-date with the latest data.

##################################################
### STARTING EXECUTION ###
##################################################


--- Processing Query ---
User Question: 'Find the details for the client named Kathleen Vasqez.'
-> STEP 1: Router Decision: **SEMANTIC_SEARCH**
-> STEP 2: Executing SEMANTIC SEARCH pipeline (using '../sheets/loan.xlsx' for context lookup)...
-> SUCCESS: Semantic context retrieved (Score: 0.8827). Context preview:

context retrived from vectordb:
[index 194] loan_application_id:1b2fa939-9af5-4610-81a0-bf379320a656 | applicant_name:Kathleen Vasquez | loan_amount_requested:32300.7 | loan_type:Student | applicant_income:72110.12 | credit_score:519 | loan_status:Approved | repayment_schedule:Quarterly | interest_rate:8.04 | loan_term:24 | collateral:college | application_date:2025-05-11 | approved_amount:38840.8 | repayment_start_date:nan | is_employed:True | monthly_payment:886.0
[index 195] loan_application_id:a863654e-ab2d-4bc1-abbb-b3e608d81015 | applicant_name:Judy Johnson MD | loan_amount_requested:37088.98 | loan_type:Student | applicant_income:33316.9 | credit_score:793 | loan_status:In Review | repayment_schedule:Quarterly | interest_rate:3.46 | loan_term:60 | collateral:nan | application_date:2025-05-17 | approved_amount:38381.06 | repayment_start_date:2025-08-28 | is_employed:True | monthly_payment:611.11

[index 774] loan_application_id:c958189b-f0fc-414e-b54a-3d49b931c2ae | applicant_name:Mrs. Katrina Barnes MD | loan_amount_requested:34136.14 | loan_type:Business | applicant_income:47169.71 | credit_score:563 | loan_status:In Review | repayment_schedule:Quarterly | interest_rate:3.56 | loan_term:48 | collateral:support | application_date:2025-08-19 | approved_amount:23724.83 | repayment_start_date:nan | is_employed:True | monthly_payment:804.17
[index 775] loan_application_id:8a7f9cac-c77b-4e70-a156-c355a7788c9e | applicant_name:Cody Hernandez | loan_amount_requested:16719.42 | loan_type:Auto | applicant_income:32416.94 | credit_score:709 | loan_status:Approved | repayment_schedule:Annually | interest_rate:3.26 | loan_term:36 | collateral:nan | application_date:2025-08-17 | approved_amount:nan | repayment_start_date:nan | is_employed:False | monthly_payment:1477.09

[index 484] loan_application_id:83a93f25-2b77-41f1-9a9c-8ee0e49819c9 | applicant_name:Kathleen Rivera | loan_amount_requested:27353.57 | loan_type:Mortgage | applicant_income:55438.79 | credit_score:554 | loan_status:In Review | repayment_schedule:Quarterly | interest_rate:7.72 | loan_term:24 | collateral:through | application_date:2025-08-18 | approved_amount:nan | repayment_start_date:nan | is_employed:False | monthly_payment:1226.45
[index 485] loan_application_id:05db383c-d566-4588-9b06-0a337eeb2742 | applicant_name:Jermaine Ramirez | loan_amount_requested:45300.54 | loan_type:Business | applicant_income:59175.47 | credit_score:722 | loan_status:Approved | repayment_schedule:Quarterly | interest_rate:7.33 | loan_term:48 | collateral:nan | application_date:2025-11-13 | approved_amount:nan | repayment_start_date:nan | is_employed:False | monthly_payment:1382.77

[index 36] loan_application_id:a0d0fc40-e309-4ae6-b1d3-004b05c98e5d | applicant_name:Pamela Sandoval | loan_amount_requested:8715.08 | loan_type:Mortgage | applicant_income:107106.97 | credit_score:508 | loan_status:Pending | repayment_schedule:Quarterly | interest_rate:3.16 | loan_term:24 | collateral:past | application_date:2025-11-18 | approved_amount:8211.5 | repayment_start_date:2025-08-16 | is_employed:True | monthly_payment:629.58
[index 37] loan_application_id:46c8b0f5-f10e-4964-bc5b-95ddca089247 | applicant_name:Victoria Butler | loan_amount_requested:38386.34 | loan_type:Mortgage | applicant_income:39214.64 | credit_score:662 | loan_status:Approved | repayment_schedule:Quarterly | interest_rate:4.3 | loan_term:12 | collateral:nan | application_date:2025-07-11 | approved_amount:nan | repayment_start_date:2025-11-26 | is_employed:True | monthly_payment:1116.22

[index 120] loan_application_id:8bf4e2ce-cf63-459d-9f56-78ea2fea3e3f | applicant_name:Kathy Figueroa | loan_amount_requested:37029.2 | loan_type:Mortgage | applicant_income:93671.9 | credit_score:441 | loan_status:In Review | repayment_schedule:Monthly | interest_rate:7.97 | loan_term:12 | collateral:including | application_date:2025-08-23 | approved_amount:nan | repayment_start_date:nan | is_employed:True | monthly_payment:1292.42
[index 121] loan_application_id:3e1ace13-b488-48ca-9309-c6649e46116a | applicant_name:Joyce Kim | loan_amount_requested:24970.57 | loan_type:Mortgage | applicant_income:42344.19 | credit_score:665 | loan_status:Denied | repayment_schedule:Monthly | interest_rate:4.44 | loan_term:48 | collateral:nan | application_date:2025-01-16 | approved_amount:49531.28 | repayment_start_date:nan | is_employed:True | monthly_payment:462.32

[index 48] loan_application_id:1db50306-ffc4-4b09-848c-3e93908bbcfc | applicant_name:Aaron Vazquez | loan_amount_requested:37618.06 | loan_type:Student | applicant_income:53923.6 | credit_score:683 | loan_status:Pending | repayment_schedule:Annually | interest_rate:8.68 | loan_term:60 | collateral:stay | application_date:2025-05-22 | approved_amount:25606.88 | repayment_start_date:2025-02-23 | is_employed:True | monthly_payment:373.27
[index 49] loan_application_id:5801a7dd-ae3a-426d-9d94-15ffbd46155d | applicant_name:Vincent Castro | loan_amount_requested:6684.81 | loan_type:Student | applicant_income:94621.78 | credit_score:466 | loan_status:In Review | repayment_schedule:Annually | interest_rate:3.9 | loan_term:24 | collateral:center | application_date:2025-01-12 | approved_amount:46044.82 | repayment_start_date:2025-05-01 | is_employed:False | monthly_payment:709.33

[index 526] loan_application_id:357b739b-0cdd-424b-8a3c-14b69d4bd256 | applicant_name:Katherine Morrow | loan_amount_requested:33521.95 | loan_type:Business | applicant_income:91047.1 | credit_score:809 | loan_status:In Review | repayment_schedule:Monthly | interest_rate:9.0 | loan_term:48 | collateral:skill | application_date:2025-04-13 | approved_amount:7121.64 | repayment_start_date:2025-09-25 | is_employed:True | monthly_payment:1463.59
[index 527] loan_application_id:e3cca660-327e-400a-be9d-d629083a5841 | applicant_name:Amanda Khan | loan_amount_requested:48289.62 | loan_type:Business | applicant_income:30395.96 | credit_score:770 | loan_status:Approved | repayment_schedule:Annually | interest_rate:7.2 | loan_term:24 | collateral:nan | application_date:2025-04-22 | approved_amount:40981.17 | repayment_start_date:nan | is_employed:True | monthly_payment:1015.22

-> Context found. Prompt will be augmented.
-> STEP 3: Calling LLM to generate SQL...
-> Generated SQL: SELECT * FROM read_parquet('../data/loan_20251209194135_c3ba6776.parquet') WHERE applicant_name = 'Kathleen Vasquez';
-> STEP 4: Executing DuckDB query...
--- Query Finished in 5.85 seconds (Semantic lookup: 2.33s) ---

Query Result:
| loan_application_id                  | applicant_name   |   loan_amount_requested | loan_type   |   applicant_income |   credit_score | loan_status   | repayment_schedule   |   interest_rate |   loan_term | collateral   | application_date   |   approved_amount | repayment_start_date   | is_employed   |   monthly_payment |
|:-------------------------------------|:-----------------|------------------------:|:------------|-------------------:|---------------:|:--------------|:---------------------|----------------:|------------:|:-------------|:-------------------|------------------:|:-----------------------|:--------------|------------------:|
| 1b2fa939-9af5-4610-81a0-bf379320a656 | Kathleen Vasquez |                 32300.7 | Student     |            72110.1 |            519 | Approved      | Quarterly            |            8.04 |          24 | college      | 2025-05-11         |           38840.8 |                        | True          |               886 |


--- Processing Query ---
User Question: 'What is the maximum average applicant_income for all loans?'
-> STEP 1: Router Decision: **SQL_QUERY**
-> STEP 2: Executing DIRECT SQL pipeline. No vector search needed.
-> STEP 3: Calling LLM to generate SQL...
-> Generated SQL: SELECT MAX(applicant_income) AS max_average_applicant_income FROM read_parquet('../data/loan_20251209194135_c3ba6776.parquet');
-> STEP 4: Executing DuckDB query...
--- Query Finished in 2.46 seconds (Semantic lookup: 0.00s) ---

Query Result:
|   max_average_applicant_income |
|-------------------------------:|
|                         119998 |

--- Execution Complete ---